<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø±Ø³ØªÙˆØ±Ø§Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ</title>
<link href="https://cdn.jsdelivr.net/gh/rastikerdar/vazir-font@v30.1.0/dist/font-face.css" rel="stylesheet">
<style>
body {font-family:'Vazir',sans-serif; margin:0; padding:0; background:#fff8f0;}
header {background:linear-gradient(135deg,#ff7f50,#ffb347); color:white; text-align:center; padding:14px 0; font-size:22px; font-weight:bold; position:sticky; top:0; box-shadow:0 2px 5px rgba(0,0,0,0.2);}
.container {max-width:600px; margin:auto; padding:10px;}
.group-select, #searchItem {width:100%; padding:8px; font-size:16px; margin-bottom:10px; border-radius:6px; border:1px solid #ccc;}
.card {margin-top:10px; background:#f0f0f0; padding:10px; border-radius:10px;}
.item-row {display:flex; justify-content:space-between; align-items:center; padding:5px 0; border-bottom:1px solid #ddd;}
.item-name {flex:2; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;}
.item-price {flex:1; text-align:left;}
.qty-control {flex:1; display:flex; justify-content:flex-end; align-items:center; gap:5px;}
.qty-control button {width:30px; height:30px; border:none; background:#ff7f50; color:white; border-radius:6px; font-weight:bold; cursor:pointer;}
.qty-control span {min-width:25px; text-align:center; display:inline-block;}
.btn-secondary {background:#555; color:white; margin:5px; padding:6px 12px; cursor:pointer; border:none; border-radius:6px;}
.btn-secondary:hover {background:#333;}
.total-bar {position:fixed; bottom:0; left:0; width:100%; background:#ff7f50; color:white; font-weight:bold; font-size:18px; text-align:center; padding:10px; box-shadow:0 -2px 5px rgba(0,0,0,0.1);}
table {width:100%; border-collapse:collapse;}
th, td {border:1px solid #ccc; padding:5px; text-align:center;}
</style>
</head>
<body>

<header>
ğŸ½ Ø±Ø³ØªÙˆØ±Ø§Ù† Ø­Ø±ÙÙ‡â€ŒØ§ÛŒ<br>
<span id="date" style="font-size:14px;"></span>
</header>

<div class="container">

<select id="groupSelect" class="group-select" onchange="renderItems()"></select>
<input type="text" id="searchItem" placeholder="ğŸ” Ø¬Ø³ØªØ¬ÙˆÛŒ Ø¢ÛŒØªÙ…" oninput="renderItems()">

<div class="card" id="itemsContainer"></div>

<div style="text-align:center; margin-top:10px;">
<button class="btn-secondary" onclick="clearOrder()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø³ÙØ§Ø±Ø´</button>
<button class="btn-secondary" onclick="printInvoice()">Ú†Ø§Ù¾ ÙØ§Ú©ØªÙˆØ±</button>
<button class="btn-secondary" onclick="renderReport()">Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡</button>
<button class="btn-secondary" onclick="showMenuEditor()">ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ù†Ùˆ</button>
</div>

<div class="card">
<h3>ğŸ“‹ ÙØ§Ú©ØªÙˆØ± Ø³ÙØ§Ø±Ø´</h3>
<table id="orderTable">
<thead><tr><th>Ù†Ø§Ù… Ø¢ÛŒØªÙ…</th><th>ØªØ¹Ø¯Ø§Ø¯</th><th>Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th><th>Ø¬Ù…Ø¹</th></tr></thead>
<tbody></tbody>
</table>
</div>

<div class="card">
<h3>ğŸ“Š Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡</h3>
<table id="reportTable">
<thead><tr><th>ØªØ§Ø±ÛŒØ®</th><th>Ø¬Ù…Ø¹ Ú©Ù„</th></tr></thead>
<tbody></tbody>
</table>
<button class="btn-secondary" onclick="clearReport()">Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´</button>
</div>

</div>

<div class="total-bar" id="totalBar">Ø¬Ù…Ø¹ Ú©Ù„: Û° ØªÙˆÙ…Ø§Ù†</div>

<script>
// Ù…Ù†ÙˆÛŒ Ù¾ÛŒØ´â€ŒÙØ±Ø¶
let menu = [
{name:"Ú©ÙˆØ¨ÛŒØ¯Ù‡", price:110000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ú¯ÙˆØ´Øª", price:130000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ù‚Ù„ÙˆÙ‡", price:120000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø¬ÙˆØ¬Ù‡", price:110000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø¬Ú¯Ø±", price:120000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø¬Ú¯Ø± Ø³ÙÛŒØ¯", price:70000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø±Ø§Ø³ØªÙ‡", price:250000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø±ÙˆÙ„Øª", price:220000, group:"Ú¯ÙˆØ´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø®ÙˆØ±Ø´Øª Ù‚ÛŒÙ…Ù‡", price:350000, group:"Ø®ÙˆØ±Ø´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ù…Ø§Ù‡ÛŒÚ†Ù‡", price:650000, group:"Ø®ÙˆØ±Ø´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ú†Ù„Ùˆ Ø¬ÙˆØ¬Ù‡ ØªÚ© Ø³ÛŒØ®", price:200000, group:"Ø®ÙˆØ±Ø´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ú†Ù„Ùˆ Ø¬ÙˆØ¬Ù‡ Ø¯Ùˆ Ø³ÛŒØ®", price:320000, group:"Ø®ÙˆØ±Ø´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ú†Ù„Ùˆ Ú©ÙˆØ¨ÛŒØ¯Ù‡ ØªÚ© Ø³ÛŒØ®", price:190000, group:"Ø®ÙˆØ±Ø´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ú†Ù„Ùˆ Ú©ÙˆØ¨ÛŒØ¯Ù‡ Ø¯Ùˆ Ø³ÛŒØ®", price:300000, group:"Ø®ÙˆØ±Ø´Øªâ€ŒÙ‡Ø§", qty:0},
{name:"Ø¢Ø´", price:80000, group:"Ø³Ø§Ø¯Ù‡â€ŒÙ‡Ø§", qty:0},
{name:"Ø¨Ø±Ù†Ø¬ Ø®Ø§Ù„ÛŒ", price:80000, group:"Ø³Ø§Ø¯Ù‡â€ŒÙ‡Ø§", qty:0},
{name:"Ø¢Ø¨Ú¯ÙˆØ´Øª", price:300000, group:"Ø³Ø§Ø¯Ù‡â€ŒÙ‡Ø§", qty:0},
{name:"Ù†ÙˆØ´Ø§Ø¨Ù‡ Ø´ÛŒØ´Ù‡", price:30000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ù†ÙˆØ´Ø§Ø¨Ù‡ Ù‚ÙˆØ·ÛŒ Ø¨Ø²Ø±Ú¯ Ùˆ Ú©ÙˆÚ†Ú©", price:50000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ù†ÙˆØ´Ø§Ø¨Ù‡ Û±/Ûµ Ù„ÛŒØªØ±", price:60000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ø¯ÙˆØº Ø¢Ø¨Ø¹Ù„ÛŒ", price:40000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ø¯ÙˆØº Ù„ÛŒÙˆØ§Ù†ÛŒ", price:30000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ù…Ø§Ø³Øª Ø®ÛŒØ§Ø±", price:30000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"ØªØ±Ø´ÛŒ", price:30000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ø²ÛŒØªÙˆÙ† Ø³Ø§Ø¯Ù‡/Ù¾Ø±ÙˆØ±Ø¯Ù‡", price:50000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0},
{name:"Ù…Ø§Ø³Øª Ù…ÙˆØ³ÛŒØ±", price:30000, group:"Ù†ÙˆØ´ÛŒØ¯Ù†ÛŒ Ùˆ Ø³Ø§Ù„Ø§Ø¯", qty:0}
];

let report = JSON.parse(localStorage.getItem("report")||"[]");

// Ø±Ù†Ø¯Ø± Ú¯Ø±ÙˆÙ‡â€ŒÙ‡Ø§
function renderGroupSelect(){
    const groups = [...new Set(menu.map(i=>i.group))];
    const sel = document.getElementById("groupSelect");
    sel.innerHTML="";
    groups.forEach(g=>{
        const opt = document.createElement("option");
        opt.value = g;
        opt.textContent = g;
        sel.appendChild(opt);
    });
}

// Ø±Ù†Ø¯Ø± Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§ Ø¨Ø§ Ø¬Ø³ØªØ¬Ùˆ Ø§Ø² Ú©Ù„ Ø¢ÛŒØªÙ…â€ŒÙ‡Ø§
function renderItems(){
    const search = document.getElementById("searchItem").value.trim();
    const container = document.getElementById("itemsContainer");
    container.innerHTML="";

    let filteredItems;
    if(search===""){
        const group = document.getElementById("groupSelect").value;
        filteredItems = menu.filter(i => i.group === group);
    } else {
        filteredItems = menu.filter(i => i.name.includes(search));
    }

    filteredItems.forEach(item => {
        const index = menu.indexOf(item);
        const row = document.createElement("div");
        row.className="item-row";
        row.innerHTML=`
            <div class="item-name">${item.name}</div>
            <div class="item-price">${item.price.toLocaleString()} ØªÙˆÙ…Ø§Ù†</div>
            <div class="qty-control">
                <button onclick="changeQty(${index},-1)">-</button>
                <span id="qty${index}">${item.qty}</span>
                <button onclick="changeQty(${index},1)">+</button>
                <button onclick="editItem(${index})" style="background:#28a745;margin-left:5px;">âœï¸</button>
                <button onclick="deleteItem(${index})" style="background:#dc3545;margin-left:5px;">ğŸ—‘ï¸</button>
            </div>
        `;
        container.appendChild(row);
    });

    renderOrder();
}

// ØªØºÛŒÛŒØ± ØªØ¹Ø¯Ø§Ø¯
function changeQty(index,delta){
    menu[index].qty += delta;
    if(menu[index].qty<0) menu[index].qty=0;
    document.getElementById(`qty${index}`).textContent=menu[index].qty;
    renderOrder();
}

// Ø±Ù†Ø¯Ø± ÙØ§Ú©ØªÙˆØ±
function renderOrder(){
    const tbody=document.querySelector("#orderTable tbody");
    tbody.innerHTML="";
    let totalSum=0;
    menu.forEach(o=>{
        if(o.qty>0){
            const total=o.price*o.qty;
            totalSum+=total;
            tbody.innerHTML+=`<tr><td>${o.name}</td><td>${o.qty}</td><td>${o.price.toLocaleString()}</td><td>${total.toLocaleString()}</td></tr>`;
        }
    });
    document.getElementById("totalBar").textContent=`Ø¬Ù…Ø¹ Ú©Ù„: ${totalSum.toLocaleString()} ØªÙˆÙ…Ø§Ù†`;
    document.getElementById("date").textContent=getPersianDate();
}

// Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ø³ÙØ§Ø±Ø´
function clearOrder(){menu.forEach(i=>i.qty=0); renderItems();}

// Ú†Ø§Ù¾ ÙØ§Ú©ØªÙˆØ± Ùˆ Ø°Ø®ÛŒØ±Ù‡ Ú¯Ø²Ø§Ø±Ø´
function printInvoice(){
    let totalSum=0;
    const orderItems = menu.filter(i=>i.qty>0);
    if(orderItems.length===0){alert("Ù‡ÛŒÚ† Ø³ÙØ§Ø±Ø´ÛŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯!"); return;}
    const win=window.open('','_blank');
    let html=`<html><head><meta charset="UTF-8"><title>ÙØ§Ú©ØªÙˆØ±</title></head><body style="font-family:Vazir;"><h2>ÙØ§Ú©ØªÙˆØ± Ø±Ø³ØªÙˆØ±Ø§Ù†</h2><table border="1" style="border-collapse:collapse;width:100%"><tr><th>Ù†Ø§Ù… Ø¢ÛŒØªÙ…</th><th>ØªØ¹Ø¯Ø§Ø¯</th><th>Ù‚ÛŒÙ…Øª ÙˆØ§Ø­Ø¯</th><th>Ø¬Ù…Ø¹</th></tr>`;
    orderItems.forEach(o=>{const total=o.price*o.qty; totalSum+=total; html+=`<tr><td>${o.name}</td><td>${o.qty}</td><td>${o.price.toLocaleString()}</td><td>${total.toLocaleString()}</td></tr>`;});
    html+=`</table><h3>Ø¬Ù…Ø¹ Ú©Ù„: ${totalSum.toLocaleString()} ØªÙˆÙ…Ø§Ù†</h3><p>${getPersianDate()}</p></body></html>`;
    win.document.write(html); win.document.close();
    report.push({date:getPersianDate(),total:totalSum});
    localStorage.setItem("report",JSON.stringify(report));
    clearOrder(); renderReport();
}

// Ú¯Ø²Ø§Ø±Ø´ Ø±ÙˆØ²Ø§Ù†Ù‡
function renderReport(){
    const tbody=document.querySelector("#reportTable tbody");
    tbody.innerHTML="";
    report.forEach(r=>{tbody.innerHTML+=`<tr><td>${r.date}</td><td>${r.total.toLocaleString()}</td></tr>`;});
}

// Ù¾Ø§Ú© Ú©Ø±Ø¯Ù† Ú¯Ø²Ø§Ø±Ø´
function clearReport(){if(confirm("Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ØŸ")){report=[];localStorage.removeItem("report");renderReport();}}

// ØªØ§Ø±ÛŒØ® Ø´Ù…Ø³ÛŒ
function getPersianDate(){return new Intl.DateTimeFormat("fa-IR",{dateStyle:"full",timeStyle:"short"}).format(new Date());}

// ÙˆÛŒØ±Ø§ÛŒØ´ Ù…Ù†Ùˆ
function showMenuEditor(){
    const action = prompt("Ø¹Ù…Ù„ÛŒØ§Øª: Û±-Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù†ØŒ Û²-ÙˆÛŒØ±Ø§ÛŒØ´ ÛŒÚ© Ø¢ÛŒØªÙ…ØŒ Û³-Ø­Ø°Ù Ø¢ÛŒØªÙ…\nØ¹Ø¯Ø¯ Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯:");
    if(action==="1"){addItem();}
    else if(action==="2"){let idx = parseInt(prompt("Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ… Ø¨Ø±Ø§ÛŒ ÙˆÛŒØ±Ø§ÛŒØ´ (Ø§Ø¨ØªØ¯Ø§ Ø¬Ø³ØªØ¬Ùˆ Ùˆ Ø´Ù…Ø§Ø±Ù‡ Ø±Ø¯ÛŒÙ Ø±Ø§ Ù…Ø´Ø§Ù‡Ø¯Ù‡ Ú©Ù†ÛŒØ¯):")); if(!isNaN(idx)) editItem(idx);}
    else if(action==="3"){let idx = parseInt(prompt("Ø´Ù…Ø§Ø±Ù‡ Ø¢ÛŒØªÙ… Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù:")); if(!isNaN(idx)) deleteItem(idx);}
}

// Ø§Ø¶Ø§ÙÙ‡ Ú©Ø±Ø¯Ù† Ø¢ÛŒØªÙ…
function addItem(){
    let name = prompt("Ù†Ø§Ù… Ø¢ÛŒØªÙ… Ø¬Ø¯ÛŒØ¯:");
    if(!name) return;
    let price = parseInt(prompt("Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†):"));
    if(isNaN(price)) return alert("Ù‚ÛŒÙ…Øª Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª!");
    let group = prompt("Ú¯Ø±ÙˆÙ‡ Ø¢ÛŒØªÙ…:");
    if(!group) group="Ø³Ø§ÛŒØ±";
    menu.push({name, price, group, qty:0});
    renderGroupSelect(); renderItems();
}

// ÙˆÛŒØ±Ø§ÛŒØ´ Ø¢ÛŒØªÙ…
function editItem(index){
    if(index<0 || index>=menu.length) return;
    let name = prompt("Ù†Ø§Ù… Ø¢ÛŒØªÙ…:", menu[index].name);
    if(!name) return;
    let price = parseInt(prompt("Ù‚ÛŒÙ…Øª (ØªÙˆÙ…Ø§Ù†):", menu[index].price));
    if(isNaN(price)) return alert("Ù‚ÛŒÙ…Øª Ù…Ø¹ØªØ¨Ø± Ù†ÛŒØ³Øª!");
    let group = prompt("Ú¯Ø±ÙˆÙ‡ Ø¢ÛŒØªÙ…:", menu[index].group);
    if(!group) group="Ø³Ø§ÛŒØ±";
    menu[index].name=name; menu[index].price=price; menu[index].group=group;
    renderGroupSelect(); renderItems();
}

// Ø­Ø°Ù Ø¢ÛŒØªÙ…
function deleteItem(index){
    if(index<0 || index>=menu.length) return;
    if(confirm(`Ø¢ÛŒØ§ Ù…Ø·Ù…Ø¦Ù† Ù‡Ø³ØªÛŒØ¯ Ú©Ù‡ "${menu[index].name}" Ø­Ø°Ù Ø´ÙˆØ¯ØŸ`)){
        menu.splice(index,1);
        renderGroupSelect(); renderItems();
    }
}

// Ø§Ø¬Ø±Ø§ Ø§ÙˆÙ„ÛŒÙ‡
renderGroupSelect();
renderItems();
renderReport();
</script>

</body>
</html>